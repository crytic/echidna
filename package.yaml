name: echidna

author: Trail of Bits <echidna-dev@trailofbits.com>
maintainer: Trail of Bits <echidna-dev@trailofbits.com>

version: 2.0.4

ghc-options: -Wall -fno-warn-orphans -O2 -threaded +RTS -N -RTS

dependencies:
  - base
  - aeson
  - ansi-terminal
  - base16-bytestring
  - binary
  - brick
  - base16-bytestring
  - bytestring
  - containers
  - data-dword
  - data-has
  - deepseq
  - extra
  - directory
  - exceptions
  - filepath
  - hashable
  - hevm
  - html-entities
  - lens
  - lens-aeson
  - ListLike
  - MonadRandom
  - mtl
  - optparse-applicative
  - process
  - random
  - rosezipper
  - semver
  - sbv
  - split
  - temporary
  - text
  - transformers
  - time
  - unix
  - unliftio
  - utf8-string
  - unordered-containers
  - vector
  - vector-instances
  - vty
  - word-wrap
  - yaml

default-extensions:
  - OverloadedStrings
  # GHC2021 default extensions from 9.2
  - FlexibleContexts
  - FlexibleInstances
  - ImportQualifiedPost
  - LambdaCase
  - MultiParamTypeClasses
  - NamedFieldPuns
  - RankNTypes
  - ScopedTypeVariables
  - StandaloneDeriving
  - TupleSections

library:
  source-dirs: lib/

executables:
  echidna-test:
    main: Main.hs
    source-dirs: src/
    dependencies: echidna
    when:
        - condition: os(linux) && flag(static)
          ghc-options:
            - -static
            - -O2
          cc-options: -static
          ld-options: -static -pthread
        - condition: os(linux)
          ghc-options:
            - -O2
          ld-options: -pthread

tests:
  echidna-testsuite:
    main: Spec.hs
    source-dirs: src/test
    dependencies:
      - echidna
      - tasty
      - tasty-hunit
      - tasty-quickcheck
    when:
        - condition: os(linux) && flag(static)
          ghc-options:
            - -static
            - -O2
          cc-options: -static
          ld-options: -static -pthread
        - condition: os(linux)
          ghc-options:
            - -O2
          ld-options: -pthread

flags:
  static:
    description: Pass -static to ghc when linking the stack binary.
    manual: true
    default: true
